<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#171717">
    <title>Game News Forge Dashboard</title>
    <link rel="stylesheet" href="/css/dashboard.css">
    <% if (isDev) { %>
    <style>
        .dev-banner {
            position: fixed;
            top: 15px;
            right: 15px;
            background-color: #d30000;
            color: white;
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 4px;
            z-index: 9999;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            font-size: 16px;
            transform: rotate(5deg);
        }
    </style>
    <% } %>
</head>
<body>
    <% if (isDev) { %>
    <div class="dev-banner">DEV</div>
    <% } %>
    <nav class="navbar" role="navigation">
        <div class="navbar-container">
            <a class="navbar-brand" href="#">Game News Forge</a>
            <div class="navbar-actions">
                <a href="https://discord.com/oauth2/authorize?client_id=1239574548928794655&permissions=2684354560&integration_type=0&scope=bot" class="add-bot-button" target="_blank" aria-label="Add bot to Discord server">Add to Discord</a>
                <span class="navbar-user" aria-label="User information">
                    Welcome, <%= user.username %>
                </span>
            </div>
        </div>
    </nav>

    <div class="main-container">
        <div class="servers-panel" role="region" aria-label="Your Discord servers">
            <h2>Your Servers</h2>
            <ul class="server-list" role="list">
                <% guilds.forEach(function(guild) { %>
                    <li class="server-item" data-guild-id="<%= guild.id %>" role="listitem" tabindex="0">
                        <img src="https://cdn.discordapp.com/icons/<%= guild.id %>/<%= guild.icon %>.png" alt="<%= guild.name %> server icon" class="server-icon" onerror="this.src='/img/game-news-forge-logo-light.png'">
                        <span class="server-name"><%= guild.name %></span>
                    </li>
                <% }); %>
            </ul>
        </div>
        <div class="games-panel" id="gamesContainer" role="region" aria-label="Games list">
            <h2>Select a server to manage games</h2>
            <p>Click on a server from the list to view and manage game subscriptions.</p>
        </div>
    </div>

    <!-- Load module scripts with type="module" attribute -->
    <script nonce="<%= nonce %>" type="module" src="/js/dashboard.js"></script>
</body>
</html>